<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="reservation_airline_content_view">
        <!-- Main Params -->
        <div class="row">
            <div class="col-12">
                <span style="font-size: 28px; font-weight: 730">Itinerary Detail(s)</span><br/>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <t t-foreach="doc.provider_booking_ids" t-as="provider_itin_id">
                    <table class="table table-sm" style="text-align:center;">
                        <thead>
                            <tr>
                                <th>PNR</th>
                                <th>Departure</th>
                                <th>Arrival</th>
                                <th>Carrier</th>
                                <th>Flight</th>
<!--                                <th>Departure Date</th>-->
<!--                                <th>Arrival Date</th>-->
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="doc.segment_ids.filtered(lambda x:x.pnr == provider_itin_id.pnr)" t-as="provider_segment_id">
                                <tr>
                                    <td><span t-field="provider_segment_id.pnr"/></td>
                                    <td>
                                        <span t-field="provider_segment_id.origin_id.name"/><br/>
                                        <span t-esc="time.strftime('%d %b %Y %H:%M', time.strptime(provider_segment_id.departure_date[:16],'%Y-%m-%d %H:%M'))"/>
                                    </td>
                                    <td>
                                        <span t-field="provider_segment_id.destination_id.name"/><br/>
                                        <span t-esc="time.strftime('%d %b %Y %H:%M', time.strptime(provider_segment_id.arrival_date[:16],'%Y-%m-%d %H:%M'))"/>
                                    </td>
                                    <td><span t-field="provider_segment_id.carrier_id.name"/></td>
                                    <td><span t-field="provider_segment_id.name"/></td>
<!--                                    <td><span t-field="provider_segment_id.departure_date" t-options ='{"format": "dd/MM/yyyy HH:mm:ss"}'/></td>-->
<!--                                    <td><span t-esc="time.strftime('%d %b %Y %H:%M', time.strptime(provider_segment_id.departure_date[:16],'%Y-%m-%d %H:%M'))"/></td>-->
<!--                                    <td><span t-esc="time.strftime('%d %b %Y %H:%M', time.strptime(provider_segment_id.arrival_date[:16],'%Y-%m-%d %H:%M'))"/></td>-->
                                </tr>
                            </t>
                        </tbody>
                    </table>

                    <span style="font-size: 28px; font-weight: 730">Passenger Detail(s)</span><br/>
                    <div class="box" style="margin: 20px 20px 20px 20px; border-style: solid; border-width: 1px; border-color: #BBB; border-radius: 20px">
                        <div class="row" style="margin-left: 0px; margin-right: 0px; margin-top: 5px; margin-bottom: 5px">
                            <div class="col-1" style="text-align: center; font-size:17px;">
                                No.
                            </div>
                            <div class="col-4" style="text-align: center; font-size:17px;">
                                Name
                            </div>
                            <div class="col-2" style="text-align: center; font-size:17px;">
                                Facility(s)
                            </div>
                            <div class="col-2" style="text-align: center; font-size:17px;">
                                Pax Type
                            </div>
                            <div class="col-3" style="text-align: right; font-size:17px; padding-right: 30px;">
                                Ticket Number
                            </div>
                        </div>
                        <div style="border: 1px solid #BBB; margin-bottom: 5px; margin-left: 15px; margin-right: 15px"/>
                        <t t-set="psg_index" t-value="0"/>
                        <t t-foreach="provider_itin_id.ticket_ids" t-as="psg">
                            <div class="row" style="margin-left: 0px; margin-right: 0px">
                                <div class="col-1" style="text-align: center">
                                    <label style="font-weight:450; font-size:17px; margin-bottom: 0px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><span t-esc="psg_index+1"/>.</label>
                                </div>
                                <div class="col-4" style="text-align: left">
                                    <label style="font-weight:450; font-size:17px; margin-bottom: 0px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><span t-field="psg.passenger_id.title"/> <span t-field="psg.passenger_id.name"/></label>
                                </div>
                                <div class="col-2" style="text-align: center">
                                    -
                                    <!--                                    <i style="margin-right:3px;" class="fa fa-suitcase"/>-->
                                    <!--                                    <i style="margin-right:3px;" class="fa fa-cutlery"/>-->
                                    <!--                                    <i style="margin-right:3px;" class="fa fa-wheelchair"/>-->
                                </div>
                                <div class="col-2" style="text-align: center">
                                    <label style="font-weight:450; font-size:17px; margin-bottom: 0px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><span t-field="psg.pax_type"/></label>
                                </div>
                                <div class="col-3" style="text-align: right">
                                    <label style="font-weight:450; font-size:17px; margin-bottom: 0px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><t t-if="psg.ticket_number"><span t-field="psg.ticket_number"/></t><t t-else="">-</t></label>
                                </div>
                            </div>
                        </t>
                        <div style="margin-bottom: 5px"/>
                    </div>
                </t>
            </div>
        </div>
    </template>

    <template id="itinerary_price_detail">
        <br/>
        <span style="font-size: 28px; font-weight: 730">Price Detail(s)</span><br/>
        <table width="100%">
            <thead style="border-bottom: 1px solid black; font-size:18px; text-align:center;">
                <td><b>Name</b></td>
                <td><b>Pax Type</b></td>
                <td><b>Base Fare</b></td>
                <td><b>Tax</b></td>
                <td><b>Total Per Pax</b></td>
            </thead>
            <t t-foreach="price_lines[doc.id]" t-as="price">
                <tr style="border-bottom: 1px solid lightgray">
                    <td style="border-right: 1px solid lightgray"><t t-esc="price['name']"/></td>
                    <td style="border-right: 1px solid lightgray"><t t-esc="price['pax_type']"/></td>
                    <td style="text-align:right; border-right: 1px solid lightgray"><t t-esc="price['fare']" t-esc-option="widget:monetary; currency_id:doc.currency_id"/></td>
                    <td style="text-align:right; border-right: 1px solid lightgray"><t t-esc="price['tax']" t-esc-option="widget:monetary; currency_id:doc.currency_id"/></td>
                    <td style="text-align:right;"><t t-esc="float(price['fare']) + float(price['tax'])" t-esc-option="widget:monetary; currency_id:doc.currency_id"/></td>
                </tr>
            </t>
        </table>
    </template>

    <template id="itinerary_signature">
        <div class="row">
            <div class="col-11">
                I, the undersigned, declare that the reservations I have made correspond to my true IDs and I made this statement consciously without any
                enforcement from anyone.
            </div>
        </div>
        <br/><br/>
        <table width="100%">
            <tr>
                <td width="80%"/>
                <td width="20%" style="text-align:center">
                    Surabaya, <t t-esc="date_now"/><br/>
                    <p>Buyer</p>
                    <p style="color: white;">.</p>
                    <p style="color: white;">.</p>
                    <p style="color: white;">.</p>
                    <p>(............................)</p>
                    <p style="border-top: 1px solid black">Representative Signature</p>
                </td>
            </tr>
        </table>
    </template>

    <template id="printout_itinerary">
        <t t-set="data_report_header_spacing" t-value="20"/>
        <t t-set="data_report_margin_top" t-value="2"/>
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <div class="page">
                    <t t-call="tt_report_common.external_layout">
                        <t t-call="tt_report_common.reservation_airline_content_view"/>
                        <t t-call="tt_report_common.itinerary_price_detail"/>
                        <br/>
                        <t t-call="tt_report_common.itinerary_signature"/>
                    </t>
                </div>
            </t>
        </t>
    </template>
</odoo>